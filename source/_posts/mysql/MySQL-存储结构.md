---
title: MySQL-存储结构
date: 2021-08-22 21:55:54
cover: /img/cover/MySQL.jpg
tags:
- 存储结构
categories:
- MySQL
updated:
type:
comments:
description:
keywords:
top_img:
mathjax:
katex:
aside:
aplayer:
highlight_shrink:
---

#### 参考文献

* 极客时间--SQL必知必会(陈旸)

#### 数据库中存储结构

* 记录是按照行来存储的，但是数据库的读取并不是以行为单位，否则一次读取（也就是一次I/O操作）只能处理一行数据，效率会非常低，因此在数据库中，不论读一行，还是读多行，都是将这些行所在的页进行加载，也就是说，**数据库管理存储空间的基本单位是页(Page)**

* 一页中可以存储多个行记录(ROW)，同时在数据库中，还存在着区(Extent)，段(Segment)和表空间(Tablespace)。行，页，区，段，表空间的关系如下图：

  ![img](https://www.chenjunlin.vip/img/mysql/%E8%A1%8C,%E9%A1%B5,%E5%8C%BA,%E6%AE%B5,%E8%A1%A8%E7%A9%BA%E9%97%B4%E5%85%B3%E7%B3%BB.png)

  * 区是比页大一级的存储结构，在InnoDB存储引擎中，一个区会分配64个连续的页，因为InnoDB中的页大小默认是16KB，所以一个区的大小是64*16KB=1MB

  * 段由一个或多个区组成，区在文件系统是一个连续分配的空间（在InnoDB中连续的64个页），不过在段中不要求与区之间是相邻的，段是数据库中的分配单位，不同类型的数据库对象以不同的段形式存在。当创建数据表，索引的时候，就会相应的创建对应的段，比如创建一张表时会创建一个表段，创建一个索引就会创建一个索引段。

  * 表空间时一个逻辑容器，表空间存储的对象是段，在一个表空间中科院有一个或多个段，但是一个段只能属于一个表空间。数据库由一个或多个表空间组成，表空间从管理上可以划分为系统表空间，用户表空间，撤销表空间，临时表空间等。

  * 在InnoDB中存在两种表空间的类型：共享表空间和独立表空间。如果是共享表空间就是意味着多张表共用一个表空间。如果是独立表空间，就意味着每一张表有一个独立的表空间，也就是数据和索引信息都会保存在自己的表空间中。独立的表空间可以在不同的数据库之间进行迁移。

  * 可以通过`show variables like 'innodb_file_per_table';`

    ![img](https://www.chenjunlin.vip/img/mysql/innodb_file_per_table.png)

    * `Innodb_file_per_table=ON`，意味着每张表都会单独保存在一个`.ibd`文件

#### 数据页的结构

* 页如果按类型划分的话，常见的数据页(保存B+树节点),系统页,Undo页和事务数据等.数据页是最长用的页.
* 表页的大小限定了表行的最大长度,不同的DBMS的表页大小不同.
